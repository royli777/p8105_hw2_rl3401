---
title: "p8105_hw2_rl3401.Rmd"
author: "Ruoxi Li"
date: "2023-09-26"
output: github_document
---
```{r,echo=FALSE}
Sys.setenv(LANGUAGE = "en")
```

```{r}
library(tidyverse)
library(readxl)
```


## Problem 1

clean the data in pols-month.csv

```{r}
pols_df = read_csv("data/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(month = case_when(
    month == "01" ~ "jan",
    month == "02" ~ "feb",
    month == "03" ~ "mar",
    month == "04" ~ "apr",
    month == "05" ~ "may",
    month == "06" ~ "jun",
    month == "07" ~ "jul",
    month == "08" ~ "aug",
    month == "09" ~ "sep",
    month == "10" ~ "oct",
    month == "11" ~ "nov",
    month == "12" ~ "dec",
  )) |>
  mutate(president = case_match(
    prez_dem,
    0 ~ "gop",
    1 ~ "dem"
  )) |>
  select(-prez_dem, -prez_gop) |>
  select(-day)
```

clean the data in snp.csv 

```{r}
date_format <- "%m/%d/%y"
snp_df = read_csv("data/snp.csv", col_types = cols(date = col_date(format = date_format))) |>
  janitor::clean_names() |>
  separate(date, into = c("year", "month", "day"), sep = "-") |>
   mutate(month = case_when(
    month == "01" ~ "jan",
    month == "02" ~ "feb",
    month == "03" ~ "mar",
    month == "04" ~ "apr",
    month == "05" ~ "may",
    month == "06" ~ "jun",
    month == "07" ~ "jul",
    month == "08" ~ "aug",
    month == "09" ~ "sep",
    month == "10" ~ "oct",
    month == "11" ~ "nov",
    month == "12" ~ "dec",
  )) |>
    select(-day) |>
  arrange(year,month) |>
  relocate(year,month)  
```

tidy the unemployment data 

```{r}
unemployment_df = read_csv("data/unemployment.csv") |>
   janitor::clean_names() |>
   mutate(year = as.character(year))|>
   pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_rate",
  ) 
```

Join the datasets by merging snp into pols, and merging unemployment into the result

```{r}
final_df = 
  left_join(pols_df, snp_df, by = c("year","month"))|>
  left_join(unemployment_df, by = c("year","month") )
```

Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

## problem 2

Read and clean the Mr. Trash Wheel sheet

```{r}
mr_trash_df = 
read_excel("data/TWC.xlsx", sheet = "Mr. Trash Wheel", skip = 1, range = cell_cols("A:N")) |>
  janitor::clean_names()  |>
  drop_na(dumpster) |>
  mutate(
    year=as.integer(year),
    homes_powered = weight_tons*500/30,
    wheel_type = "mr")
```

import, clean, and organize the data for Professor Trash Wheel and Gwynnda


```{r}
pro_trash_df = 
  read_excel("data/TWC.xlsx", sheet = "Professor Trash Wheel", skip = 1, range = cell_cols("A:M")) |>
  janitor::clean_names()  |>
  drop_na(dumpster) |>
  mutate(
    year=as.integer(year),
    homes_powered = weight_tons*500/30,
    wheel_type = "prof")

gwy_trash_df = 
  read_excel("data/TWC.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1, range = cell_cols("A:K")) |>
  janitor::clean_names()  |>
  drop_na(dumpster) |>
  mutate(
    year=as.integer(year),
    homes_powered = weight_tons*500/30,
    wheel_type = "gwy")
```