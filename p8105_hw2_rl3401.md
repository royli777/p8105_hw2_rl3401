p8105_hw2_rl3401.Rmd
================
Ruoxi Li
2023-09-26

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

## Problem 1

clean the data in pols-month.csv

``` r
pols_df = read_csv("data/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(month = case_when(
    month == "01" ~ "jan",
    month == "02" ~ "feb",
    month == "03" ~ "mar",
    month == "04" ~ "apr",
    month == "05" ~ "may",
    month == "06" ~ "jun",
    month == "07" ~ "jul",
    month == "08" ~ "aug",
    month == "09" ~ "sep",
    month == "10" ~ "oct",
    month == "11" ~ "nov",
    month == "12" ~ "dec",
  )) |>
  mutate(president = case_match(
    prez_dem,
    0 ~ "gop",
    1 ~ "dem"
  )) |>
  select(-prez_dem, -prez_gop) |>
  select(-day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

clean the data in snp.csv

``` r
date_format <- "%m/%d/%y"
snp_df = read_csv("data/snp.csv", col_types = cols(date = col_date(format = date_format))) |>
  janitor::clean_names() |>
  separate(date, into = c("year", "month", "day"), sep = "-") |>
   mutate(month = case_when(
    month == "01" ~ "jan",
    month == "02" ~ "feb",
    month == "03" ~ "mar",
    month == "04" ~ "apr",
    month == "05" ~ "may",
    month == "06" ~ "jun",
    month == "07" ~ "jul",
    month == "08" ~ "aug",
    month == "09" ~ "sep",
    month == "10" ~ "oct",
    month == "11" ~ "nov",
    month == "12" ~ "dec",
  )) |>
    select(-day) |>
  arrange(year,month) |>
  relocate(year,month)  
```

tidy the unemployment data

``` r
unemployment_df = read_csv("data/unemployment.csv") |>
   janitor::clean_names() |>
   mutate(year = as.character(year))|>
   pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_rate",
  ) 
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets by merging snp into pols, and merging unemployment
into the result

``` r
final_df = 
  left_join(pols_df, snp_df, by = c("year","month"))|>
  left_join(unemployment_df, by = c("year","month") )
```

Write a short paragraph about these datasets. Explain briefly what each
dataset contained, and describe the resulting dataset (e.g. give the
dimension, range of years, and names of key variables).

## problem 2

Read and clean the Mr. Trash Wheel sheet

``` r
mr_trash_df = 
read_excel("data/TWC.xlsx", sheet = "Mr. Trash Wheel", skip = 1, range = cell_cols("A:N")) |>
  janitor::clean_names()  |>
  drop_na(dumpster) |>
  mutate(
    year=as.integer(year),
    homes_powered = weight_tons*500/30,
    wheel_type = "mr")
```

import, clean, and organize the data for Professor Trash Wheel and
Gwynnda

``` r
pro_trash_df = 
  read_excel("data/TWC.xlsx", sheet = "Professor Trash Wheel", skip = 1, range = cell_cols("A:M")) |>
  janitor::clean_names()  |>
  drop_na(dumpster) |>
  mutate(
    year=as.integer(year),
    homes_powered = weight_tons*500/30,
    wheel_type = "prof")

gwy_trash_df = 
  read_excel("data/TWC.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1, range = cell_cols("A:K")) |>
  janitor::clean_names()  |>
  drop_na(dumpster) |>
  mutate(
    year=as.integer(year),
    homes_powered = weight_tons*500/30,
    wheel_type = "gwy")
```

Combine datasets to produce a single tidy dataset

``` r
trash_df = 
  bind_rows(mr_trash_df, pro_trash_df, gwy_trash_df) |>
  relocate(wheel_type)
```

Write a paragraph about these data; you are encouraged to use inline R.
Be sure to note the number of observations in the resulting dataset, and
give examples of key variables. For available data, what was the total
weight of trash collected by Professor Trash Wheel? What was the total
number of cigarette butts collected by Gwynnda in July of 2021?

## problem 3

Import, clean, and tidy the dataset of baseline demographics

``` r
baseline_df = 
read_csv("data/MCI_baseline.csv", skip = 1,show_col_types = FALSE) |>
  janitor::clean_names()  |>
  filter(age_at_onset == "." | age_at_onset > current_age)|>
   mutate(
      sex = case_match(
      sex,
      1 ~ "male",
      0 ~ "female"),
      apoe4  = case_match(
      apoe4,
      1 ~ "carrier",
      0 ~ "non_carrier"),
      current_age = as.numeric(current_age)
  ) 
```

Discuss important steps in the import process and relevant features of
the dataset. How many participants were recruited, and of these how many
develop MCI? What is the average baseline age? What proportion of women
in the study are APOE4 carriers?

import, clean, and tidy the dataset of longitudinally observed biomarker
values

``` r
amyloid_df = 
read_csv("data/mci_amyloid.csv", skip = 1,show_col_types = FALSE) |>
  janitor::clean_names()  |>
  rename("id" = "study_id")
```

comment on the steps on the import process and the features of the
dataset.
